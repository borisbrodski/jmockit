<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
   <title>The JMockit Testing Toolkit Tutorial</title>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
   <link rel="stylesheet" type="text/css" href="../prettify.css"/>
</head>
<body>
<h2>
   Running tests with JMockit
   <div class="navigation">
      <a href="../tutorial.html"><img align="right" src="go-home.png" title="Contents"></a>
      <a href="BehaviorBasedTesting.html"><img align="right" src="go-next.png" title="Next chapter"></a>
      <a href="AnExample.html"><img align="right" src="go-previous.png" title="Previous chapter"></a>
   </div>
</h2>

<p>
   To run tests that use any of the JMockit APIs, use your Java IDE, Ant script, etc. the way you
   normally would, as long as the JVM gets a chance to load the "Java agent" which provides
   instrumentation access to JMockit (it's inside <code>jmockit.jar</code>).
   For that, you have several options, from easiest to most complex:
</p>
<ol>
<li>
   First of all, add <code>jmockit.jar</code> to the classpath.
   <ul>
      <li>
         For JUnit test suites, make sure that <code>jmockit.jar</code> appears <em>before</em> any
         JUnit jar in the classpath. Only JUnit 4.5 or newer is supported.
      </li>
      <li>
         For TestNG test suites, configure TestNG with the
         <code>mockit.integration.testng.Initializer</code>
         <a href="http://testng.org/doc/documentation-main.html#testng-listeners">test listener</a>.
         This can be done by passing <code>-listener mockit.integration.testng.Initializer</code> as
         a test runner argument in the JVM command line.
         When using Maven, the listener can be specified by configuring the
         <code>maven-surefire-plugin</code> with a property of name "listener" and a value
         containing "mockit.integration.testng.Initializer" (see
         <a href="http://maven.apache.org/plugins/maven-surefire-plugin/examples/testng.html">this
            page</a> for more details).
         Another way is to specify the listener in the <code>testng.xml</code> configuration file:
         <code style="white-space: nowrap;">&lt;listener class-name="mockit.integration.testng.Initializer"/></code>.
      </li>
   </ul>
   This option applies to what probably is the most common development environment: Windows or
   Linux with a Sun JDK of version 1.6 or newer.
</li>
<li>
   Along with <code>jmockit.jar</code>, add <code>&lt;jdkHome>/lib/tools.jar</code> from a JDK 1.6
   installation to the classpath.
   (This standard JDK 1.6 library contains the Sun Attach API which JMockit uses to automatically
   load the Java agent from <code>jmockit.jar</code>. Although this API is not yet part of Java SE,
   the JDKs from Sun, Oracle, IBM, and Apple come with it, to the best of my knowledge.)
   This will be necessary in environments such as Mac OS X which are not supported by the Attach API
   implementation classes from OpenJDK embedded in <code>jmockit.jar</code> (currently, these
   classes support only Windows and Linux JVMs).
</li>
<li>
   Alternatively, or if you only have a JDK 1.5 installation available, pass
   <code>-javaagent:jmockit.jar</code> as a JVM initialization parameter.
   This can easily be done in the "Run/Debug Configuration" for both Eclipse and IntelliJ IDEA.
   (Note that if <code>jmockit.jar</code> is not in the current working directory when running the
   tests, you will have to insert the appropriate absolute or relative path after the colon, so the
   JVM can locate the jar file.)
</li>
</ol>
<p>
   If use of the <code>-javaagent</code> JVM parameter is not desired, but for some reason
   <code>jmockit.jar</code> cannot precede <code>junit.jar</code> in the classpath or the TestNG
   listener cannot be used, then all test classes must make sure that JMockit gets initialized
   <em>before</em> the first test in the suite gets executed.
   This can be achieved by creating a static test class initializer or a <code>@BeforeClass</code>
   method (in JUnit 4) with a call to <strong><code>Mockit.setUpMocks()</code></strong>.
   This option can be used with any supported version of JUnit or TestNG.
</p>
<div class="navigation">
   <a href="../tutorial.html"><img align="right" src="go-home.png" title="Contents"></a>
   <a href="BehaviorBasedTesting.html"><img align="right" src="go-next.png" title="Next chapter"></a>
   <a href="AnExample.html"><img align="right" src="go-previous.png" title="Previous chapter"></a>
</div>
<br/>
<script type="text/javascript" src="../prettify.js"></script>
</body>
</html>
